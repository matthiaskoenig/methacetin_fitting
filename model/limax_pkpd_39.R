# -----------------------------------------------------------
# Autogenerated ODE definition from SBML file with sbmlutils.
#
#    model: limax_pkpd_39
# -----------------------------------------------------------

# -------------------
# ids
# -------------------
xids <- c("Aar_apap", "Aar_co2c13", "Aar_metc13", "Abo_apap", "Abo_co2c13", "Abo_co2c13_fix", "Abo_metc13", "Abreath_co2c13", "Agu_apap", "Agu_co2c13", "Agu_metc13", "Ahe_apap", "Ahe_co2c13", "Ahe_metc13", "Aki_apap", "Aki_co2c13", "Aki_metc13", "Ali_apap", "Ali_co2c13", "Ali_metc13", "Alu_apap", "Alu_co2c13", "Alu_metc13", "Are_apap", "Are_co2c13", "Are_metc13", "Asp_apap", "Asp_co2c13", "Asp_metc13", "Aurine_apap", "Aurine_co2c13", "Aurine_metc13", "Ave_apap", "Ave_co2c13", "Ave_metc13", "IVDOSE_apap", "IVDOSE_co2c13", "IVDOSE_metc13", "PODOSE_apap", "PODOSE_co2c13", "PODOSE_metc13", "cum_dose_apap", "cum_dose_co2c13", "cum_dose_metc13")
pids <- c("APAPD_HLM_CL", "APAPD_Km_apap", "BP_apap", "BP_co2c13", "BP_metc13", "BW", "CLrenal_apap", "CLrenal_co2c13", "CLrenal_metc13", "CO2FIX_HLM_CL", "CO2FIX_Km_co2", "COBW", "COHRI", "CYP1A2MET_CL", "CYP1A2MET_Km_met", "FQbo", "FQgu", "FQh", "FQhe", "FQki", "FQlu", "FQsp", "FVar", "FVbo", "FVgu", "FVhe", "FVki", "FVli", "FVlu", "FVpl", "FVsp", "FVve", "F_PAR", "F_apap", "F_co2c13", "F_metc13", "HEIGHT", "HR", "HRrest", "KBO_FIXCO2", "KBO_MAXCO2", "KBO_RELCO2", "KLU_EXCO2", "Ka_apap", "Ka_co2c13", "Ka_metc13", "Kpbo_apap", "Kpbo_co2c13", "Kpbo_metc13", "Kpgu_apap", "Kpgu_co2c13", "Kpgu_metc13", "Kphe_apap", "Kphe_co2c13", "Kphe_metc13", "Kpki_apap", "Kpki_co2c13", "Kpki_metc13", "Kpli_apap", "Kpli_co2c13", "Kpli_metc13", "Kplu_apap", "Kplu_co2c13", "Kplu_metc13", "Kpre_apap", "Kpre_co2c13", "Kpre_metc13", "Kpsp_apap", "Kpsp_co2c13", "Kpsp_metc13", "MPPGL", "Mr_apap", "Mr_co2c13", "Mr_metc13", "P_CO2BSA", "R_PDB", "Ri_apap", "Ri_co2c13", "Ri_metc13", "Vbreath", "Vurine", "fumic_apap", "fumic_co2c13", "fumic_metc13", "fup_apap", "fup_co2c13", "fup_metc13", "ti_apap", "ti_co2c13", "ti_metc13")
yids <- c("Absorption_apap", "Absorption_co2c13", "Absorption_metc13", "BSA", "CO", "FQre", "FVre", "Infusion_apap", "Infusion_co2c13", "Infusion_metc13", "Ki_apap", "Ki_co2c13", "Ki_metc13", "Var", "Vbo", "Vgu", "Vhe", "Vki", "Vli", "Vlu", "Vpl", "Vsp", "Vve", "Xar_apap", "Xar_co2c13", "Xar_metc13", "Xbo_apap", "Xbo_co2c13", "Xbo_co2c13_fix", "Xbo_metc13", "Xbreath_co2c13", "Xgu_apap", "Xgu_co2c13", "Xgu_metc13", "Xhe_apap", "Xhe_co2c13", "Xhe_metc13", "Xki_apap", "Xki_co2c13", "Xki_metc13", "Xli_apap", "Xli_co2c13", "Xli_metc13", "Xlu_apap", "Xlu_co2c13", "Xlu_metc13", "Xre_apap", "Xre_co2c13", "Xre_metc13", "Xsp_apap", "Xsp_co2c13", "Xsp_metc13", "Xurine_apap", "Xurine_co2c13", "Xurine_metc13", "Xve_apap", "Xve_co2c13", "Xve_metc13", "APAPD_CLliv", "CO2FIX_CLliv", "CYP1A2MET_CLliv", "Car_apap", "Car_co2c13", "Car_metc13", "Cbo_apap", "Cbo_co2c13", "Cbo_co2c13_fix", "Cbo_metc13", "Cgu_apap", "Cgu_co2c13", "Cgu_metc13", "Che_apap", "Che_co2c13", "Che_metc13", "Cki_apap", "Cki_co2c13", "Cki_metc13", "Cli_apap", "Cli_co2c13", "Cli_metc13", "Clu_apap", "Clu_co2c13", "Clu_metc13", "Csp_apap", "Csp_co2c13", "Csp_metc13", "Cve_apap", "Cve_co2c13", "Cve_metc13", "Injection_apap", "Injection_co2c13", "Injection_metc13", "Mar_apap", "Mar_co2c13", "Mar_metc13", "Mbo_apap", "Mbo_co2c13", "Mbo_metc13", "Mgu_apap", "Mgu_co2c13", "Mgu_metc13", "Mhe_apap", "Mhe_co2c13", "Mhe_metc13", "Mki_apap", "Mki_co2c13", "Mki_metc13", "Mli_apap", "Mli_co2c13", "Mli_metc13", "Mlu_apap", "Mlu_co2c13", "Mlu_metc13", "Msp_apap", "Msp_co2c13", "Msp_metc13", "Mve_apap", "Mve_co2c13", "Mve_metc13", "P_CO2", "QC", "Vplas_art", "Vplas_ven", "Vre", "Xbody_apap", "Xbody_co2c13", "Xbody_metc13", "CO2FIX", "Cki_free_apap", "Cki_free_co2c13", "Cki_free_metc13", "Cli_free_apap", "Cli_free_co2c13", "Cli_free_metc13", "Cpl_ve_apap", "Cpl_ve_co2c13", "Cpl_ve_metc13", "Cre_apap", "Cre_co2c13", "Cre_metc13", "Exhalation_co2c13", "Fixation_co2c13", "Mre_apap", "Mre_co2c13", "Mre_metc13", "P_CO2c12", "Qbo", "Qgu", "Qh", "Qhe", "Qki", "Qlu", "Qre", "Qsp", "Release_co2c13", "APAPD", "CYP1A2MET", "P_CO2c13", "Qha", "ar_bo_apap", "ar_bo_co2c13", "ar_bo_metc13", "ar_gu_apap", "ar_gu_co2c13", "ar_gu_metc13", "ar_he_apap", "ar_he_co2c13", "ar_he_metc13", "ar_ki_apap", "ar_ki_co2c13", "ar_ki_metc13", "ar_re_apap", "ar_re_co2c13", "ar_re_metc13", "ar_sp_apap", "ar_sp_co2c13", "ar_sp_metc13", "bo_ve_apap", "bo_ve_co2c13", "bo_ve_metc13", "gu_li_apap", "gu_li_co2c13", "gu_li_metc13", "he_ve_apap", "he_ve_co2c13", "he_ve_metc13", "ki_ve_apap", "ki_ve_co2c13", "ki_ve_metc13", "li_ve_apap", "li_ve_co2c13", "li_ve_metc13", "lu_ar_apap", "lu_ar_co2c13", "lu_ar_metc13", "re_ve_apap", "re_ve_co2c13", "re_ve_metc13", "sp_li_apap", "sp_li_co2c13", "sp_li_metc13", "ve_lu_apap", "ve_lu_co2c13", "ve_lu_metc13", "vre_apap", "vre_co2c13", "vre_metc13", "DOB", "P_CO2Fc13", "P_CO2R", "ar_li_apap", "ar_li_co2c13", "ar_li_metc13")

# -------------------
# initial conditions
# -------------------
x0 = c(
  Aar_apap = 0.0,      # [1]
  Aar_co2c13 = 0.0,      # [2]
  Aar_metc13 = 0.0,      # [3]
  Abo_apap = 0.0,      # [4]
  Abo_co2c13 = 0.0,      # [5]
  Abo_co2c13_fix = 0.0,      # [6]
  Abo_metc13 = 0.0,      # [7]
  Abreath_co2c13 = 0.0,      # [8]
  Agu_apap = 0.0,      # [9]
  Agu_co2c13 = 0.0,      # [10]
  Agu_metc13 = 0.0,      # [11]
  Ahe_apap = 0.0,      # [12]
  Ahe_co2c13 = 0.0,      # [13]
  Ahe_metc13 = 0.0,      # [14]
  Aki_apap = 0.0,      # [15]
  Aki_co2c13 = 0.0,      # [16]
  Aki_metc13 = 0.0,      # [17]
  Ali_apap = 0.0,      # [18]
  Ali_co2c13 = 0.0,      # [19]
  Ali_metc13 = 0.0,      # [20]
  Alu_apap = 0.0,      # [21]
  Alu_co2c13 = 0.0,      # [22]
  Alu_metc13 = 0.0,      # [23]
  Are_apap = 0.0,      # [24]
  Are_co2c13 = 0.0,      # [25]
  Are_metc13 = 0.0,      # [26]
  Asp_apap = 0.0,      # [27]
  Asp_co2c13 = 0.0,      # [28]
  Asp_metc13 = 0.0,      # [29]
  Aurine_apap = 0.0,      # [30]
  Aurine_co2c13 = 0.0,      # [31]
  Aurine_metc13 = 0.0,      # [32]
  Ave_apap = 0.0,      # [33]
  Ave_co2c13 = 0.0,      # [34]
  Ave_metc13 = 0.0,      # [35]
  IVDOSE_apap = 0.0,      # [36]
  IVDOSE_co2c13 = 0.0,      # [37]
  IVDOSE_metc13 = 0.0,      # [38]
  PODOSE_apap = 0.0,      # [39]
  PODOSE_co2c13 = 0.0,      # [40]
  PODOSE_metc13 = 0.0,      # [41]
  cum_dose_apap = 0.0,      # [42]
  cum_dose_co2c13 = 0.0,      # [43]
  cum_dose_metc13 = 0.0      # [44]
)

# -------------------
# parameters
# -------------------
p = c(
  APAPD_HLM_CL = 2.5,      # [1]
  APAPD_Km_apap = 0.5,      # [2]
  BP_apap = 1.0,      # [3]
  BP_co2c13 = 1.0,      # [4]
  BP_metc13 = 1.0,      # [5]
  BW = 75.0,      # [6]
  CLrenal_apap = 0.714,      # [7]
  CLrenal_co2c13 = 0.0,      # [8]
  CLrenal_metc13 = 10.0,      # [9]
  CO2FIX_HLM_CL = 1.5,      # [10]
  CO2FIX_Km_co2 = 0.2,      # [11]
  COBW = 1.548,      # [12]
  COHRI = 150.0,      # [13]
  CYP1A2MET_CL = 1.5,      # [14]
  CYP1A2MET_Km_met = 0.02,      # [15]
  FQbo = 0.05,      # [16]
  FQgu = 0.146,      # [17]
  FQh = 0.215,      # [18]
  FQhe = 0.04,      # [19]
  FQki = 0.19,      # [20]
  FQlu = 1.0,      # [21]
  FQsp = 0.017,      # [22]
  FVar = 0.0257,      # [23]
  FVbo = 0.0856,      # [24]
  FVgu = 0.0171,      # [25]
  FVhe = 0.0047,      # [26]
  FVki = 0.0044,      # [27]
  FVli = 0.021,      # [28]
  FVlu = 0.0076,      # [29]
  FVpl = 0.0424,      # [30]
  FVsp = 0.0026,      # [31]
  FVve = 0.0514,      # [32]
  F_PAR = 0.85,      # [33]
  F_apap = 0.87,      # [34]
  F_co2c13 = 1.0,      # [35]
  F_metc13 = 1.0,      # [36]
  HEIGHT = 170.0,      # [37]
  HR = 70.0,      # [38]
  HRrest = 70.0,      # [39]
  KBO_FIXCO2 = 0.1,      # [40]
  KBO_MAXCO2 = 0.2,      # [41]
  KBO_RELCO2 = 0.0001,      # [42]
  KLU_EXCO2 = 1.2,      # [43]
  Ka_apap = 2.5,      # [44]
  Ka_co2c13 = 8.0,      # [45]
  Ka_metc13 = 4.0,      # [46]
  Kpbo_apap = 1.0,      # [47]
  Kpbo_co2c13 = 1.0,      # [48]
  Kpbo_metc13 = 1.0,      # [49]
  Kpgu_apap = 1.0,      # [50]
  Kpgu_co2c13 = 1.0,      # [51]
  Kpgu_metc13 = 1.0,      # [52]
  Kphe_apap = 1.0,      # [53]
  Kphe_co2c13 = 1.0,      # [54]
  Kphe_metc13 = 1.0,      # [55]
  Kpki_apap = 1.0,      # [56]
  Kpki_co2c13 = 1.0,      # [57]
  Kpki_metc13 = 1.0,      # [58]
  Kpli_apap = 1.0,      # [59]
  Kpli_co2c13 = 1.0,      # [60]
  Kpli_metc13 = 1.0,      # [61]
  Kplu_apap = 1.0,      # [62]
  Kplu_co2c13 = 1.0,      # [63]
  Kplu_metc13 = 1.0,      # [64]
  Kpre_apap = 0.8,      # [65]
  Kpre_co2c13 = 1.0,      # [66]
  Kpre_metc13 = 0.2,      # [67]
  Kpsp_apap = 1.0,      # [68]
  Kpsp_co2c13 = 1.0,      # [69]
  Kpsp_metc13 = 1.0,      # [70]
  MPPGL = 45.0,      # [71]
  Mr_apap = 151.16,      # [72]
  Mr_co2c13 = 62.02,      # [73]
  Mr_metc13 = 165.19,      # [74]
  P_CO2BSA = 300.0,      # [75]
  R_PDB = 0.01123,      # [76]
  Ri_apap = 0.0,      # [77]
  Ri_co2c13 = 0.0,      # [78]
  Ri_metc13 = 0.0,      # [79]
  Vbreath = 1.0,      # [80]
  Vurine = 1.0,      # [81]
  fumic_apap = 1.0,      # [82]
  fumic_co2c13 = 1.0,      # [83]
  fumic_metc13 = 1.0,      # [84]
  fup_apap = 1.0,      # [85]
  fup_co2c13 = 1.0,      # [86]
  fup_metc13 = 1.0,      # [87]
  ti_apap = 10.0,      # [88]
  ti_co2c13 = 10.0,      # [89]
  ti_metc13 = 10.0      # [90]
)


# -------------------
# dmod odes
# -------------------
dxdt_dmod <- c(
    Aar_apap = "QC * FQlu * (Alu_apap / Vlu / Kplu_apap) * BP_apap - QC * FQre * (Aar_apap / Var) - QC * FQbo * (Aar_apap / Var) - QC * FQgu * (Aar_apap / Var) - QC * FQhe * (Aar_apap / Var) - QC * FQki * (Aar_apap / Var) - QC * FQsp * (Aar_apap / Var) - (Qh - Qgu - Qsp) * (Aar_apap / Var)",   # [1]
    Aar_co2c13 = "QC * FQlu * (Alu_co2c13 / Vlu / Kplu_co2c13) * BP_co2c13 - QC * FQre * (Aar_co2c13 / Var) - QC * FQbo * (Aar_co2c13 / Var) - QC * FQgu * (Aar_co2c13 / Var) - QC * FQhe * (Aar_co2c13 / Var) - QC * FQki * (Aar_co2c13 / Var) - QC * FQsp * (Aar_co2c13 / Var) - (Qh - Qgu - Qsp) * (Aar_co2c13 / Var)",   # [2]
    Aar_metc13 = "QC * FQlu * (Alu_metc13 / Vlu / Kplu_metc13) * BP_metc13 - QC * FQre * (Aar_metc13 / Var) - QC * FQbo * (Aar_metc13 / Var) - QC * FQgu * (Aar_metc13 / Var) - QC * FQhe * (Aar_metc13 / Var) - QC * FQki * (Aar_metc13 / Var) - QC * FQsp * (Aar_metc13 / Var) - (Qh - Qgu - Qsp) * (Aar_metc13 / Var)",   # [3]
    Abo_apap = "QC * FQbo * (Aar_apap / Var) - QC * FQbo * (Abo_apap / Vbo / Kpbo_apap) * BP_apap",   # [4]
    Abo_co2c13 = "QC * FQbo * (Aar_co2c13 / Var) - QC * FQbo * (Abo_co2c13 / Vbo / Kpbo_co2c13) * BP_co2c13",   # [5]
    Abo_co2c13_fix = "KBO_FIXCO2 * 60 * (Ave_co2c13 / Vve) * (BW * FVve) * (1 - Abo_co2c13_fix / Vbo / KBO_MAXCO2) - KBO_RELCO2 * 60 * (Abo_co2c13_fix / Vbo) * (BW * FVve)",   # [6]
    Abo_metc13 = "QC * FQbo * (Aar_metc13 / Var) - QC * FQbo * (Abo_metc13 / Vbo / Kpbo_metc13) * BP_metc13",   # [7]
    Abreath_co2c13 = "KLU_EXCO2 * 60 * (Alu_co2c13 / Vlu) * (BW * FVlu)",   # [8]
    Agu_apap = "(Ka_apap * PODOSE_apap / Mr_apap) * F_apap + QC * FQgu * (Aar_apap / Var) - QC * FQgu * (Agu_apap / Vgu / Kpgu_apap) * BP_apap",   # [9]
    Agu_co2c13 = "(Ka_co2c13 * PODOSE_co2c13 / Mr_co2c13) * F_co2c13 + QC * FQgu * (Aar_co2c13 / Var) - QC * FQgu * (Agu_co2c13 / Vgu / Kpgu_co2c13) * BP_co2c13",   # [10]
    Agu_metc13 = "(Ka_metc13 * PODOSE_metc13 / Mr_metc13) * F_metc13 + QC * FQgu * (Aar_metc13 / Var) - QC * FQgu * (Agu_metc13 / Vgu / Kpgu_metc13) * BP_metc13",   # [11]
    Ahe_apap = "QC * FQhe * (Aar_apap / Var) - QC * FQhe * (Ahe_apap / Vhe / Kphe_apap) * BP_apap",   # [12]
    Ahe_co2c13 = "QC * FQhe * (Aar_co2c13 / Var) - QC * FQhe * (Ahe_co2c13 / Vhe / Kphe_co2c13) * BP_co2c13",   # [13]
    Ahe_metc13 = "QC * FQhe * (Aar_metc13 / Var) - QC * FQhe * (Ahe_metc13 / Vhe / Kphe_metc13) * BP_metc13",   # [14]
    Aki_apap = "-(CLrenal_apap * (Cki_apap * fup_apap)) + QC * FQki * (Aar_apap / Var) - QC * FQki * (Aki_apap / Vki / Kpki_apap) * BP_apap",   # [15]
    Aki_co2c13 = "-(CLrenal_co2c13 * (Cki_co2c13 * fup_co2c13)) + QC * FQki * (Aar_co2c13 / Var) - QC * FQki * (Aki_co2c13 / Vki / Kpki_co2c13) * BP_co2c13",   # [16]
    Aki_metc13 = "-(CLrenal_metc13 * (Cki_metc13 * fup_metc13)) + QC * FQki * (Aar_metc13 / Var) - QC * FQki * (Aki_metc13 / Vki / Kpki_metc13) * BP_metc13",   # [17]
    Ali_apap = "(((CYP1A2MET_CL / fumic_metc13) * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Cli_metc13 * fup_metc13 / (Cli_metc13 * fup_metc13 + CYP1A2MET_Km_met)) - ((APAPD_HLM_CL / fumic_apap) * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Cli_apap * fup_apap / (Cli_apap * fup_apap + APAPD_Km_apap))) + QC * FQgu * (Agu_apap / Vgu / Kpgu_apap) * BP_apap + QC * FQsp * (Asp_apap / Vsp / Kpsp_apap) * BP_apap + (Qh - Qgu - Qsp) * (Aar_apap / Var) - QC * FQh * (Ali_apap / Vli / Kpli_apap) * BP_apap",   # [18]
    Ali_co2c13 = "(((CYP1A2MET_CL / fumic_metc13) * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Cli_metc13 * fup_metc13 / (Cli_metc13 * fup_metc13 + CYP1A2MET_Km_met)) - (CO2FIX_HLM_CL * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Ali_co2c13 / Vli / (Ali_co2c13 / Vli + CO2FIX_Km_co2))) + QC * FQgu * (Agu_co2c13 / Vgu / Kpgu_co2c13) * BP_co2c13 + QC * FQsp * (Asp_co2c13 / Vsp / Kpsp_co2c13) * BP_co2c13 + (Qh - Qgu - Qsp) * (Aar_co2c13 / Var) - QC * FQh * (Ali_co2c13 / Vli / Kpli_co2c13) * BP_co2c13",   # [19]
    Ali_metc13 = "-(((CYP1A2MET_CL / fumic_metc13) * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Cli_metc13 * fup_metc13 / (Cli_metc13 * fup_metc13 + CYP1A2MET_Km_met))) + QC * FQgu * (Agu_metc13 / Vgu / Kpgu_metc13) * BP_metc13 + QC * FQsp * (Asp_metc13 / Vsp / Kpsp_metc13) * BP_metc13 + (Qh - Qgu - Qsp) * (Aar_metc13 / Var) - QC * FQh * (Ali_metc13 / Vli / Kpli_metc13) * BP_metc13",   # [20]
    Alu_apap = "QC * FQlu * (Ave_apap / Vve) - QC * FQlu * (Alu_apap / Vlu / Kplu_apap) * BP_apap",   # [21]
    Alu_co2c13 = "-(KLU_EXCO2 * 60 * (Alu_co2c13 / Vlu) * (BW * FVlu)) + QC * FQlu * (Ave_co2c13 / Vve) - QC * FQlu * (Alu_co2c13 / Vlu / Kplu_co2c13) * BP_co2c13",   # [22]
    Alu_metc13 = "QC * FQlu * (Ave_metc13 / Vve) - QC * FQlu * (Alu_metc13 / Vlu / Kplu_metc13) * BP_metc13",   # [23]
    Are_apap = "QC * FQre * (Aar_apap / Var) - QC * FQre * (Are_apap / Vre / Kpre_apap) * BP_apap",   # [24]
    Are_co2c13 = "QC * FQre * (Aar_co2c13 / Var) - QC * FQre * (Are_co2c13 / Vre / Kpre_co2c13) * BP_co2c13",   # [25]
    Are_metc13 = "QC * FQre * (Aar_metc13 / Var) - QC * FQre * (Are_metc13 / Vre / Kpre_metc13) * BP_metc13",   # [26]
    Asp_apap = "QC * FQsp * (Aar_apap / Var) - QC * FQsp * (Asp_apap / Vsp / Kpsp_apap) * BP_apap",   # [27]
    Asp_co2c13 = "QC * FQsp * (Aar_co2c13 / Var) - QC * FQsp * (Asp_co2c13 / Vsp / Kpsp_co2c13) * BP_co2c13",   # [28]
    Asp_metc13 = "QC * FQsp * (Aar_metc13 / Var) - QC * FQsp * (Asp_metc13 / Vsp / Kpsp_metc13) * BP_metc13",   # [29]
    Aurine_apap = "CLrenal_apap * (Cki_apap * fup_apap)",   # [30]
    Aurine_co2c13 = "CLrenal_co2c13 * (Cki_co2c13 * fup_co2c13)",   # [31]
    Aurine_metc13 = "CLrenal_metc13 * (Cki_metc13 * fup_metc13)",   # [32]
    Ave_apap = "((1.386 / ti_apap) * 3600 * IVDOSE_apap / Mr_apap + (Ri_apap / Mr_apap) * 60 - QC * FQlu * (Ave_apap / Vve)) + QC * FQre * (Are_apap / Vre / Kpre_apap) * BP_apap + QC * FQbo * (Abo_apap / Vbo / Kpbo_apap) * BP_apap + QC * FQhe * (Ahe_apap / Vhe / Kphe_apap) * BP_apap + QC * FQki * (Aki_apap / Vki / Kpki_apap) * BP_apap + QC * FQh * (Ali_apap / Vli / Kpli_apap) * BP_apap",   # [33]
    Ave_co2c13 = "(-(KBO_FIXCO2 * 60 * (Ave_co2c13 / Vve) * (BW * FVve) * (1 - Abo_co2c13_fix / Vbo / KBO_MAXCO2)) + KBO_RELCO2 * 60 * (Abo_co2c13_fix / Vbo) * (BW * FVve) + (1.386 / ti_co2c13) * 3600 * IVDOSE_co2c13 / Mr_co2c13 + (Ri_co2c13 / Mr_co2c13) * 60 - QC * FQlu * (Ave_co2c13 / Vve)) + QC * FQre * (Are_co2c13 / Vre / Kpre_co2c13) * BP_co2c13 + QC * FQbo * (Abo_co2c13 / Vbo / Kpbo_co2c13) * BP_co2c13 + QC * FQhe * (Ahe_co2c13 / Vhe / Kphe_co2c13) * BP_co2c13 + QC * FQki * (Aki_co2c13 / Vki / Kpki_co2c13) * BP_co2c13 + QC * FQh * (Ali_co2c13 / Vli / Kpli_co2c13) * BP_co2c13",   # [34]
    Ave_metc13 = "((1.386 / ti_metc13) * 3600 * IVDOSE_metc13 / Mr_metc13 + (Ri_metc13 / Mr_metc13) * 60 - QC * FQlu * (Ave_metc13 / Vve)) + QC * FQre * (Are_metc13 / Vre / Kpre_metc13) * BP_metc13 + QC * FQbo * (Abo_metc13 / Vbo / Kpbo_metc13) * BP_metc13 + QC * FQhe * (Ahe_metc13 / Vhe / Kphe_metc13) * BP_metc13 + QC * FQki * (Aki_metc13 / Vki / Kpki_metc13) * BP_metc13 + QC * FQh * (Ali_metc13 / Vli / Kpli_metc13) * BP_metc13",   # [35]
    IVDOSE_apap = "-((1.386 / ti_apap) * 3600 * IVDOSE_apap / Mr_apap) * Mr_apap",   # [36]
    IVDOSE_co2c13 = "-((1.386 / ti_co2c13) * 3600 * IVDOSE_co2c13 / Mr_co2c13) * Mr_co2c13",   # [37]
    IVDOSE_metc13 = "-((1.386 / ti_metc13) * 3600 * IVDOSE_metc13 / Mr_metc13) * Mr_metc13",   # [38]
    PODOSE_apap = "-((Ka_apap * PODOSE_apap / Mr_apap) * F_apap) * Mr_apap",   # [39]
    PODOSE_co2c13 = "-((Ka_co2c13 * PODOSE_co2c13 / Mr_co2c13) * F_co2c13) * Mr_co2c13",   # [40]
    PODOSE_metc13 = "-((Ka_metc13 * PODOSE_metc13 / Mr_metc13) * F_metc13) * Mr_metc13",   # [41]
    cum_dose_apap = "Ri_apap * 60",   # [42]
    cum_dose_co2c13 = "Ri_co2c13 * 60",   # [43]
    cum_dose_metc13 = "Ri_metc13 * 60"  # [44]
)

y_dmod <- c(
    Absorption_apap = "(Ka_apap * PODOSE_apap / Mr_apap) * F_apap",   # [1]
    Absorption_co2c13 = "(Ka_co2c13 * PODOSE_co2c13 / Mr_co2c13) * F_co2c13",   # [2]
    Absorption_metc13 = "(Ka_metc13 * PODOSE_metc13 / Mr_metc13) * F_metc13",   # [3]
    BSA = "0.024265 * (BW / 1)**0.5378 * (HEIGHT / 1)**0.3964",   # [4]
    CO = "BW * COBW + (HR - HRrest) * COHRI / 60",   # [5]
    FQre = "1 - (FQbo + FQhe + FQgu + FQki + FQh + FQsp)",   # [6]
    FVre = "1 - (FVbo + FVhe + FVgu + FVki + FVli + FVlu + FVsp + FVve + FVar + FVpl)",   # [7]
    Infusion_apap = "(Ri_apap / Mr_apap) * 60",   # [8]
    Infusion_co2c13 = "(Ri_co2c13 / Mr_co2c13) * 60",   # [9]
    Infusion_metc13 = "(Ri_metc13 / Mr_metc13) * 60",   # [10]
    Ki_apap = "(1.386 / ti_apap) * 3600",   # [11]
    Ki_co2c13 = "(1.386 / ti_co2c13) * 3600",   # [12]
    Ki_metc13 = "(1.386 / ti_metc13) * 3600",   # [13]
    Var = "BW * FVar",   # [14]
    Vbo = "BW * FVbo",   # [15]
    Vgu = "BW * FVgu",   # [16]
    Vhe = "BW * FVhe",   # [17]
    Vki = "BW * FVki",   # [18]
    Vli = "BW * FVli",   # [19]
    Vlu = "BW * FVlu",   # [20]
    Vpl = "BW * FVpl",   # [21]
    Vsp = "BW * FVsp",   # [22]
    Vve = "BW * FVve",   # [23]
    Xar_apap = "Aar_apap * Mr_apap",   # [24]
    Xar_co2c13 = "Aar_co2c13 * Mr_co2c13",   # [25]
    Xar_metc13 = "Aar_metc13 * Mr_metc13",   # [26]
    Xbo_apap = "Abo_apap * Mr_apap",   # [27]
    Xbo_co2c13 = "Abo_co2c13 * Mr_co2c13",   # [28]
    Xbo_co2c13_fix = "Abo_co2c13_fix * Mr_co2c13",   # [29]
    Xbo_metc13 = "Abo_metc13 * Mr_metc13",   # [30]
    Xbreath_co2c13 = "Abreath_co2c13 * Mr_co2c13",   # [31]
    Xgu_apap = "Agu_apap * Mr_apap",   # [32]
    Xgu_co2c13 = "Agu_co2c13 * Mr_co2c13",   # [33]
    Xgu_metc13 = "Agu_metc13 * Mr_metc13",   # [34]
    Xhe_apap = "Ahe_apap * Mr_apap",   # [35]
    Xhe_co2c13 = "Ahe_co2c13 * Mr_co2c13",   # [36]
    Xhe_metc13 = "Ahe_metc13 * Mr_metc13",   # [37]
    Xki_apap = "Aki_apap * Mr_apap",   # [38]
    Xki_co2c13 = "Aki_co2c13 * Mr_co2c13",   # [39]
    Xki_metc13 = "Aki_metc13 * Mr_metc13",   # [40]
    Xli_apap = "Ali_apap * Mr_apap",   # [41]
    Xli_co2c13 = "Ali_co2c13 * Mr_co2c13",   # [42]
    Xli_metc13 = "Ali_metc13 * Mr_metc13",   # [43]
    Xlu_apap = "Alu_apap * Mr_apap",   # [44]
    Xlu_co2c13 = "Alu_co2c13 * Mr_co2c13",   # [45]
    Xlu_metc13 = "Alu_metc13 * Mr_metc13",   # [46]
    Xre_apap = "Are_apap * Mr_apap",   # [47]
    Xre_co2c13 = "Are_co2c13 * Mr_co2c13",   # [48]
    Xre_metc13 = "Are_metc13 * Mr_metc13",   # [49]
    Xsp_apap = "Asp_apap * Mr_apap",   # [50]
    Xsp_co2c13 = "Asp_co2c13 * Mr_co2c13",   # [51]
    Xsp_metc13 = "Asp_metc13 * Mr_metc13",   # [52]
    Xurine_apap = "Aurine_apap * Mr_apap",   # [53]
    Xurine_co2c13 = "Aurine_co2c13 * Mr_co2c13",   # [54]
    Xurine_metc13 = "Aurine_metc13 * Mr_metc13",   # [55]
    Xve_apap = "Ave_apap * Mr_apap",   # [56]
    Xve_co2c13 = "Ave_co2c13 * Mr_co2c13",   # [57]
    Xve_metc13 = "Ave_metc13 * Mr_metc13",   # [58]
    APAPD_CLliv = "(APAPD_HLM_CL / fumic_apap) * MPPGL * (BW * FVli) * F_PAR * 60 / 1000",   # [59]
    CO2FIX_CLliv = "CO2FIX_HLM_CL * MPPGL * (BW * FVli) * F_PAR * 60 / 1000",   # [60]
    CYP1A2MET_CLliv = "(CYP1A2MET_CL / fumic_metc13) * MPPGL * (BW * FVli) * F_PAR * 60 / 1000",   # [61]
    Car_apap = "Aar_apap / (BW * FVar)",   # [62]
    Car_co2c13 = "Aar_co2c13 / (BW * FVar)",   # [63]
    Car_metc13 = "Aar_metc13 / (BW * FVar)",   # [64]
    Cbo_apap = "Abo_apap / (BW * FVbo)",   # [65]
    Cbo_co2c13 = "Abo_co2c13 / (BW * FVbo)",   # [66]
    Cbo_co2c13_fix = "Abo_co2c13_fix / (BW * FVbo)",   # [67]
    Cbo_metc13 = "Abo_metc13 / (BW * FVbo)",   # [68]
    Cgu_apap = "Agu_apap / (BW * FVgu)",   # [69]
    Cgu_co2c13 = "Agu_co2c13 / (BW * FVgu)",   # [70]
    Cgu_metc13 = "Agu_metc13 / (BW * FVgu)",   # [71]
    Che_apap = "Ahe_apap / (BW * FVhe)",   # [72]
    Che_co2c13 = "Ahe_co2c13 / (BW * FVhe)",   # [73]
    Che_metc13 = "Ahe_metc13 / (BW * FVhe)",   # [74]
    Cki_apap = "Aki_apap / (BW * FVki)",   # [75]
    Cki_co2c13 = "Aki_co2c13 / (BW * FVki)",   # [76]
    Cki_metc13 = "Aki_metc13 / (BW * FVki)",   # [77]
    Cli_apap = "Ali_apap / (BW * FVli)",   # [78]
    Cli_co2c13 = "Ali_co2c13 / (BW * FVli)",   # [79]
    Cli_metc13 = "Ali_metc13 / (BW * FVli)",   # [80]
    Clu_apap = "Alu_apap / (BW * FVlu)",   # [81]
    Clu_co2c13 = "Alu_co2c13 / (BW * FVlu)",   # [82]
    Clu_metc13 = "Alu_metc13 / (BW * FVlu)",   # [83]
    Csp_apap = "Asp_apap / (BW * FVsp)",   # [84]
    Csp_co2c13 = "Asp_co2c13 / (BW * FVsp)",   # [85]
    Csp_metc13 = "Asp_metc13 / (BW * FVsp)",   # [86]
    Cve_apap = "Ave_apap / (BW * FVve)",   # [87]
    Cve_co2c13 = "Ave_co2c13 / (BW * FVve)",   # [88]
    Cve_metc13 = "Ave_metc13 / (BW * FVve)",   # [89]
    Injection_apap = "(1.386 / ti_apap) * 3600 * IVDOSE_apap / Mr_apap",   # [90]
    Injection_co2c13 = "(1.386 / ti_co2c13) * 3600 * IVDOSE_co2c13 / Mr_co2c13",   # [91]
    Injection_metc13 = "(1.386 / ti_metc13) * 3600 * IVDOSE_metc13 / Mr_metc13",   # [92]
    Mar_apap = "(Aar_apap / (BW * FVar)) * Mr_apap",   # [93]
    Mar_co2c13 = "(Aar_co2c13 / (BW * FVar)) * Mr_co2c13",   # [94]
    Mar_metc13 = "(Aar_metc13 / (BW * FVar)) * Mr_metc13",   # [95]
    Mbo_apap = "(Abo_apap / (BW * FVbo)) * Mr_apap",   # [96]
    Mbo_co2c13 = "(Abo_co2c13 / (BW * FVbo)) * Mr_co2c13",   # [97]
    Mbo_metc13 = "(Abo_metc13 / (BW * FVbo)) * Mr_metc13",   # [98]
    Mgu_apap = "(Agu_apap / (BW * FVgu)) * Mr_apap",   # [99]
    Mgu_co2c13 = "(Agu_co2c13 / (BW * FVgu)) * Mr_co2c13",   # [100]
    Mgu_metc13 = "(Agu_metc13 / (BW * FVgu)) * Mr_metc13",   # [101]
    Mhe_apap = "(Ahe_apap / (BW * FVhe)) * Mr_apap",   # [102]
    Mhe_co2c13 = "(Ahe_co2c13 / (BW * FVhe)) * Mr_co2c13",   # [103]
    Mhe_metc13 = "(Ahe_metc13 / (BW * FVhe)) * Mr_metc13",   # [104]
    Mki_apap = "(Aki_apap / (BW * FVki)) * Mr_apap",   # [105]
    Mki_co2c13 = "(Aki_co2c13 / (BW * FVki)) * Mr_co2c13",   # [106]
    Mki_metc13 = "(Aki_metc13 / (BW * FVki)) * Mr_metc13",   # [107]
    Mli_apap = "(Ali_apap / (BW * FVli)) * Mr_apap",   # [108]
    Mli_co2c13 = "(Ali_co2c13 / (BW * FVli)) * Mr_co2c13",   # [109]
    Mli_metc13 = "(Ali_metc13 / (BW * FVli)) * Mr_metc13",   # [110]
    Mlu_apap = "(Alu_apap / (BW * FVlu)) * Mr_apap",   # [111]
    Mlu_co2c13 = "(Alu_co2c13 / (BW * FVlu)) * Mr_co2c13",   # [112]
    Mlu_metc13 = "(Alu_metc13 / (BW * FVlu)) * Mr_metc13",   # [113]
    Msp_apap = "(Asp_apap / (BW * FVsp)) * Mr_apap",   # [114]
    Msp_co2c13 = "(Asp_co2c13 / (BW * FVsp)) * Mr_co2c13",   # [115]
    Msp_metc13 = "(Asp_metc13 / (BW * FVsp)) * Mr_metc13",   # [116]
    Mve_apap = "(Ave_apap / (BW * FVve)) * Mr_apap",   # [117]
    Mve_co2c13 = "(Ave_co2c13 / (BW * FVve)) * Mr_co2c13",   # [118]
    Mve_metc13 = "(Ave_metc13 / (BW * FVve)) * Mr_metc13",   # [119]
    P_CO2 = "0.024265 * (BW / 1)**0.5378 * (HEIGHT / 1)**0.3964 * P_CO2BSA / 60",   # [120]
    QC = "((BW * COBW + (HR - HRrest) * COHRI / 60) / 1000) * 3600",   # [121]
    Vplas_art = "BW * FVpl * (BW * FVar) / (BW * FVve + BW * FVar)",   # [122]
    Vplas_ven = "BW * FVpl * (BW * FVve) / (BW * FVve + BW * FVar)",   # [123]
    Vre = "BW * (1 - (FVbo + FVhe + FVgu + FVki + FVli + FVlu + FVsp + FVve + FVar + FVpl))",   # [124]
    Xbody_apap = "Aar_apap * Mr_apap + Abo_apap * Mr_apap + Ahe_apap * Mr_apap + Agu_apap * Mr_apap + Aki_apap * Mr_apap + Ali_apap * Mr_apap + Alu_apap * Mr_apap + Asp_apap * Mr_apap + Are_apap * Mr_apap + Ave_apap * Mr_apap",   # [125]
    Xbody_co2c13 = "Aar_co2c13 * Mr_co2c13 + Abo_co2c13 * Mr_co2c13 + Ahe_co2c13 * Mr_co2c13 + Agu_co2c13 * Mr_co2c13 + Aki_co2c13 * Mr_co2c13 + Ali_co2c13 * Mr_co2c13 + Alu_co2c13 * Mr_co2c13 + Asp_co2c13 * Mr_co2c13 + Are_co2c13 * Mr_co2c13 + Ave_co2c13 * Mr_co2c13",   # [126]
    Xbody_metc13 = "Aar_metc13 * Mr_metc13 + Abo_metc13 * Mr_metc13 + Ahe_metc13 * Mr_metc13 + Agu_metc13 * Mr_metc13 + Aki_metc13 * Mr_metc13 + Ali_metc13 * Mr_metc13 + Alu_metc13 * Mr_metc13 + Asp_metc13 * Mr_metc13 + Are_metc13 * Mr_metc13 + Ave_metc13 * Mr_metc13",   # [127]
    CO2FIX = "(CO2FIX_HLM_CL * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Ali_co2c13 / Vli / (Ali_co2c13 / Vli + CO2FIX_Km_co2))",   # [128]
    Cki_free_apap = "(Aki_apap / Vki) * fup_apap",   # [129]
    Cki_free_co2c13 = "(Aki_co2c13 / Vki) * fup_co2c13",   # [130]
    Cki_free_metc13 = "(Aki_metc13 / Vki) * fup_metc13",   # [131]
    Cli_free_apap = "(Ali_apap / Vli) * fup_apap",   # [132]
    Cli_free_co2c13 = "(Ali_co2c13 / Vli) * fup_co2c13",   # [133]
    Cli_free_metc13 = "(Ali_metc13 / Vli) * fup_metc13",   # [134]
    Cpl_ve_apap = "Ave_apap / Vve / BP_apap",   # [135]
    Cpl_ve_co2c13 = "Ave_co2c13 / Vve / BP_co2c13",   # [136]
    Cpl_ve_metc13 = "Ave_metc13 / Vve / BP_metc13",   # [137]
    Cre_apap = "Are_apap / (BW * FVre)",   # [138]
    Cre_co2c13 = "Are_co2c13 / (BW * FVre)",   # [139]
    Cre_metc13 = "Are_metc13 / (BW * FVre)",   # [140]
    Exhalation_co2c13 = "KLU_EXCO2 * 60 * (Alu_co2c13 / Vlu) * (BW * FVlu)",   # [141]
    Fixation_co2c13 = "KBO_FIXCO2 * 60 * (Ave_co2c13 / Vve) * (BW * FVve) * (1 - Abo_co2c13_fix / Vbo / KBO_MAXCO2)",   # [142]
    Mre_apap = "(Are_apap / (BW * FVre)) * Mr_apap",   # [143]
    Mre_co2c13 = "(Are_co2c13 / (BW * FVre)) * Mr_co2c13",   # [144]
    Mre_metc13 = "(Are_metc13 / (BW * FVre)) * Mr_metc13",   # [145]
    P_CO2c12 = "(1 / (1 + R_PDB)) * (BSA * P_CO2BSA / 60)",   # [146]
    Qbo = "(CO / 1000) * 3600 * FQbo",   # [147]
    Qgu = "(CO / 1000) * 3600 * FQgu",   # [148]
    Qh = "(CO / 1000) * 3600 * FQh",   # [149]
    Qhe = "(CO / 1000) * 3600 * FQhe",   # [150]
    Qki = "(CO / 1000) * 3600 * FQki",   # [151]
    Qlu = "(CO / 1000) * 3600 * FQlu",   # [152]
    Qre = "(CO / 1000) * 3600 * (1 - (FQbo + FQhe + FQgu + FQki + FQh + FQsp))",   # [153]
    Qsp = "(CO / 1000) * 3600 * FQsp",   # [154]
    Release_co2c13 = "KBO_RELCO2 * 60 * (Abo_co2c13_fix / Vbo) * (BW * FVve)",   # [155]
    APAPD = "((APAPD_HLM_CL / fumic_apap) * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Cli_apap * fup_apap / (Cli_apap * fup_apap + APAPD_Km_apap))",   # [156]
    CYP1A2MET = "((CYP1A2MET_CL / fumic_metc13) * MPPGL * Vli * F_PAR * 60 / 1000) * 1 * (Cli_metc13 * fup_metc13 / (Cli_metc13 * fup_metc13 + CYP1A2MET_Km_met))",   # [157]
    P_CO2c13 = "(R_PDB / (1 + R_PDB)) * (BSA * P_CO2BSA / 60) + KLU_EXCO2 * 60 * Clu_co2c13 * Vlu / 60",   # [158]
    Qha = "QC * FQh - QC * FQgu - QC * FQsp",   # [159]
    ar_bo_apap = "QC * FQbo * (Aar_apap / Var)",   # [160]
    ar_bo_co2c13 = "QC * FQbo * (Aar_co2c13 / Var)",   # [161]
    ar_bo_metc13 = "QC * FQbo * (Aar_metc13 / Var)",   # [162]
    ar_gu_apap = "QC * FQgu * (Aar_apap / Var)",   # [163]
    ar_gu_co2c13 = "QC * FQgu * (Aar_co2c13 / Var)",   # [164]
    ar_gu_metc13 = "QC * FQgu * (Aar_metc13 / Var)",   # [165]
    ar_he_apap = "QC * FQhe * (Aar_apap / Var)",   # [166]
    ar_he_co2c13 = "QC * FQhe * (Aar_co2c13 / Var)",   # [167]
    ar_he_metc13 = "QC * FQhe * (Aar_metc13 / Var)",   # [168]
    ar_ki_apap = "QC * FQki * (Aar_apap / Var)",   # [169]
    ar_ki_co2c13 = "QC * FQki * (Aar_co2c13 / Var)",   # [170]
    ar_ki_metc13 = "QC * FQki * (Aar_metc13 / Var)",   # [171]
    ar_re_apap = "QC * FQre * (Aar_apap / Var)",   # [172]
    ar_re_co2c13 = "QC * FQre * (Aar_co2c13 / Var)",   # [173]
    ar_re_metc13 = "QC * FQre * (Aar_metc13 / Var)",   # [174]
    ar_sp_apap = "QC * FQsp * (Aar_apap / Var)",   # [175]
    ar_sp_co2c13 = "QC * FQsp * (Aar_co2c13 / Var)",   # [176]
    ar_sp_metc13 = "QC * FQsp * (Aar_metc13 / Var)",   # [177]
    bo_ve_apap = "QC * FQbo * (Abo_apap / Vbo / Kpbo_apap) * BP_apap",   # [178]
    bo_ve_co2c13 = "QC * FQbo * (Abo_co2c13 / Vbo / Kpbo_co2c13) * BP_co2c13",   # [179]
    bo_ve_metc13 = "QC * FQbo * (Abo_metc13 / Vbo / Kpbo_metc13) * BP_metc13",   # [180]
    gu_li_apap = "QC * FQgu * (Agu_apap / Vgu / Kpgu_apap) * BP_apap",   # [181]
    gu_li_co2c13 = "QC * FQgu * (Agu_co2c13 / Vgu / Kpgu_co2c13) * BP_co2c13",   # [182]
    gu_li_metc13 = "QC * FQgu * (Agu_metc13 / Vgu / Kpgu_metc13) * BP_metc13",   # [183]
    he_ve_apap = "QC * FQhe * (Ahe_apap / Vhe / Kphe_apap) * BP_apap",   # [184]
    he_ve_co2c13 = "QC * FQhe * (Ahe_co2c13 / Vhe / Kphe_co2c13) * BP_co2c13",   # [185]
    he_ve_metc13 = "QC * FQhe * (Ahe_metc13 / Vhe / Kphe_metc13) * BP_metc13",   # [186]
    ki_ve_apap = "QC * FQki * (Aki_apap / Vki / Kpki_apap) * BP_apap",   # [187]
    ki_ve_co2c13 = "QC * FQki * (Aki_co2c13 / Vki / Kpki_co2c13) * BP_co2c13",   # [188]
    ki_ve_metc13 = "QC * FQki * (Aki_metc13 / Vki / Kpki_metc13) * BP_metc13",   # [189]
    li_ve_apap = "QC * FQh * (Ali_apap / Vli / Kpli_apap) * BP_apap",   # [190]
    li_ve_co2c13 = "QC * FQh * (Ali_co2c13 / Vli / Kpli_co2c13) * BP_co2c13",   # [191]
    li_ve_metc13 = "QC * FQh * (Ali_metc13 / Vli / Kpli_metc13) * BP_metc13",   # [192]
    lu_ar_apap = "QC * FQlu * (Alu_apap / Vlu / Kplu_apap) * BP_apap",   # [193]
    lu_ar_co2c13 = "QC * FQlu * (Alu_co2c13 / Vlu / Kplu_co2c13) * BP_co2c13",   # [194]
    lu_ar_metc13 = "QC * FQlu * (Alu_metc13 / Vlu / Kplu_metc13) * BP_metc13",   # [195]
    re_ve_apap = "QC * FQre * (Are_apap / Vre / Kpre_apap) * BP_apap",   # [196]
    re_ve_co2c13 = "QC * FQre * (Are_co2c13 / Vre / Kpre_co2c13) * BP_co2c13",   # [197]
    re_ve_metc13 = "QC * FQre * (Are_metc13 / Vre / Kpre_metc13) * BP_metc13",   # [198]
    sp_li_apap = "QC * FQsp * (Asp_apap / Vsp / Kpsp_apap) * BP_apap",   # [199]
    sp_li_co2c13 = "QC * FQsp * (Asp_co2c13 / Vsp / Kpsp_co2c13) * BP_co2c13",   # [200]
    sp_li_metc13 = "QC * FQsp * (Asp_metc13 / Vsp / Kpsp_metc13) * BP_metc13",   # [201]
    ve_lu_apap = "QC * FQlu * (Ave_apap / Vve)",   # [202]
    ve_lu_co2c13 = "QC * FQlu * (Ave_co2c13 / Vve)",   # [203]
    ve_lu_metc13 = "QC * FQlu * (Ave_metc13 / Vve)",   # [204]
    vre_apap = "CLrenal_apap * (Cki_apap * fup_apap)",   # [205]
    vre_co2c13 = "CLrenal_co2c13 * (Cki_co2c13 * fup_co2c13)",   # [206]
    vre_metc13 = "CLrenal_metc13 * (Cki_metc13 * fup_metc13)",   # [207]
    DOB = "((((R_PDB / (1 + R_PDB)) * P_CO2 + Exhalation_co2c13 / 60) / ((1 / (1 + R_PDB)) * P_CO2) - R_PDB) / R_PDB) * 1000",   # [208]
    P_CO2Fc13 = "((R_PDB / (1 + R_PDB)) * P_CO2 + Exhalation_co2c13 / 60) / ((1 / (1 + R_PDB)) * P_CO2 + ((R_PDB / (1 + R_PDB)) * P_CO2 + Exhalation_co2c13 / 60))",   # [209]
    P_CO2R = "((R_PDB / (1 + R_PDB)) * P_CO2 + Exhalation_co2c13 / 60) / ((1 / (1 + R_PDB)) * P_CO2)",   # [210]
    ar_li_apap = "(Qh - Qgu - Qsp) * (Aar_apap / Var)",   # [211]
    ar_li_co2c13 = "(Qh - Qgu - Qsp) * (Aar_co2c13 / Var)",   # [212]
    ar_li_metc13 = "(Qh - Qgu - Qsp) * (Aar_metc13 / Var)"  # [213]
)



# -------------------
# odes
# -------------------
f_dxdt <- function(t, x, p){
    # ODE system
    Absorption_apap = (p[44] * x[39] / p[72]) * p[34]      # [1] Absorption_apap
    Absorption_co2c13 = (p[45] * x[40] / p[73]) * p[35]      # [2] Absorption_co2c13
    Absorption_metc13 = (p[46] * x[41] / p[74]) * p[36]      # [3] Absorption_metc13
    BSA = 0.024265 * (p[6] / 1)**0.5378 * (p[37] / 1)**0.3964      # [4] BSA
    CO = p[6] * p[12] + (p[38] - p[39]) * p[13] / 60      # [5] CO
    FQre = 1 - (p[16] + p[19] + p[17] + p[20] + p[18] + p[22])      # [6] FQre
    FVre = 1 - (p[24] + p[26] + p[25] + p[27] + p[28] + p[29] + p[31] + p[32] + p[23] + p[30])      # [7] FVre
    Infusion_apap = (p[77] / p[72]) * 60      # [8] Infusion_apap
    Infusion_co2c13 = (p[78] / p[73]) * 60      # [9] Infusion_co2c13
    Infusion_metc13 = (p[79] / p[74]) * 60      # [10] Infusion_metc13
    Ki_apap = (1.386 / p[88]) * 3600      # [11] Ki_apap
    Ki_co2c13 = (1.386 / p[89]) * 3600      # [12] Ki_co2c13
    Ki_metc13 = (1.386 / p[90]) * 3600      # [13] Ki_metc13
    Var = p[6] * p[23]      # [14] Var
    Vbo = p[6] * p[24]      # [15] Vbo
    Vgu = p[6] * p[25]      # [16] Vgu
    Vhe = p[6] * p[26]      # [17] Vhe
    Vki = p[6] * p[27]      # [18] Vki
    Vli = p[6] * p[28]      # [19] Vli
    Vlu = p[6] * p[29]      # [20] Vlu
    Vpl = p[6] * p[30]      # [21] Vpl
    Vsp = p[6] * p[31]      # [22] Vsp
    Vve = p[6] * p[32]      # [23] Vve
    Xar_apap = x[1] * p[72]      # [24] Xar_apap
    Xar_co2c13 = x[2] * p[73]      # [25] Xar_co2c13
    Xar_metc13 = x[3] * p[74]      # [26] Xar_metc13
    Xbo_apap = x[4] * p[72]      # [27] Xbo_apap
    Xbo_co2c13 = x[5] * p[73]      # [28] Xbo_co2c13
    Xbo_co2c13_fix = x[6] * p[73]      # [29] Xbo_co2c13_fix
    Xbo_metc13 = x[7] * p[74]      # [30] Xbo_metc13
    Xbreath_co2c13 = x[8] * p[73]      # [31] Xbreath_co2c13
    Xgu_apap = x[9] * p[72]      # [32] Xgu_apap
    Xgu_co2c13 = x[10] * p[73]      # [33] Xgu_co2c13
    Xgu_metc13 = x[11] * p[74]      # [34] Xgu_metc13
    Xhe_apap = x[12] * p[72]      # [35] Xhe_apap
    Xhe_co2c13 = x[13] * p[73]      # [36] Xhe_co2c13
    Xhe_metc13 = x[14] * p[74]      # [37] Xhe_metc13
    Xki_apap = x[15] * p[72]      # [38] Xki_apap
    Xki_co2c13 = x[16] * p[73]      # [39] Xki_co2c13
    Xki_metc13 = x[17] * p[74]      # [40] Xki_metc13
    Xli_apap = x[18] * p[72]      # [41] Xli_apap
    Xli_co2c13 = x[19] * p[73]      # [42] Xli_co2c13
    Xli_metc13 = x[20] * p[74]      # [43] Xli_metc13
    Xlu_apap = x[21] * p[72]      # [44] Xlu_apap
    Xlu_co2c13 = x[22] * p[73]      # [45] Xlu_co2c13
    Xlu_metc13 = x[23] * p[74]      # [46] Xlu_metc13
    Xre_apap = x[24] * p[72]      # [47] Xre_apap
    Xre_co2c13 = x[25] * p[73]      # [48] Xre_co2c13
    Xre_metc13 = x[26] * p[74]      # [49] Xre_metc13
    Xsp_apap = x[27] * p[72]      # [50] Xsp_apap
    Xsp_co2c13 = x[28] * p[73]      # [51] Xsp_co2c13
    Xsp_metc13 = x[29] * p[74]      # [52] Xsp_metc13
    Xurine_apap = x[30] * p[72]      # [53] Xurine_apap
    Xurine_co2c13 = x[31] * p[73]      # [54] Xurine_co2c13
    Xurine_metc13 = x[32] * p[74]      # [55] Xurine_metc13
    Xve_apap = x[33] * p[72]      # [56] Xve_apap
    Xve_co2c13 = x[34] * p[73]      # [57] Xve_co2c13
    Xve_metc13 = x[35] * p[74]      # [58] Xve_metc13
    APAPD_CLliv = (p[1] / p[82]) * p[71] * Vli * p[33] * 60 / 1000      # [59] APAPD_CLliv
    CO2FIX_CLliv = p[10] * p[71] * Vli * p[33] * 60 / 1000      # [60] CO2FIX_CLliv
    CYP1A2MET_CLliv = (p[14] / p[84]) * p[71] * Vli * p[33] * 60 / 1000      # [61] CYP1A2MET_CLliv
    Car_apap = x[1] / Var      # [62] Car_apap
    Car_co2c13 = x[2] / Var      # [63] Car_co2c13
    Car_metc13 = x[3] / Var      # [64] Car_metc13
    Cbo_apap = x[4] / Vbo      # [65] Cbo_apap
    Cbo_co2c13 = x[5] / Vbo      # [66] Cbo_co2c13
    Cbo_co2c13_fix = x[6] / Vbo      # [67] Cbo_co2c13_fix
    Cbo_metc13 = x[7] / Vbo      # [68] Cbo_metc13
    Cgu_apap = x[9] / Vgu      # [69] Cgu_apap
    Cgu_co2c13 = x[10] / Vgu      # [70] Cgu_co2c13
    Cgu_metc13 = x[11] / Vgu      # [71] Cgu_metc13
    Che_apap = x[12] / Vhe      # [72] Che_apap
    Che_co2c13 = x[13] / Vhe      # [73] Che_co2c13
    Che_metc13 = x[14] / Vhe      # [74] Che_metc13
    Cki_apap = x[15] / Vki      # [75] Cki_apap
    Cki_co2c13 = x[16] / Vki      # [76] Cki_co2c13
    Cki_metc13 = x[17] / Vki      # [77] Cki_metc13
    Cli_apap = x[18] / Vli      # [78] Cli_apap
    Cli_co2c13 = x[19] / Vli      # [79] Cli_co2c13
    Cli_metc13 = x[20] / Vli      # [80] Cli_metc13
    Clu_apap = x[21] / Vlu      # [81] Clu_apap
    Clu_co2c13 = x[22] / Vlu      # [82] Clu_co2c13
    Clu_metc13 = x[23] / Vlu      # [83] Clu_metc13
    Csp_apap = x[27] / Vsp      # [84] Csp_apap
    Csp_co2c13 = x[28] / Vsp      # [85] Csp_co2c13
    Csp_metc13 = x[29] / Vsp      # [86] Csp_metc13
    Cve_apap = x[33] / Vve      # [87] Cve_apap
    Cve_co2c13 = x[34] / Vve      # [88] Cve_co2c13
    Cve_metc13 = x[35] / Vve      # [89] Cve_metc13
    Injection_apap = Ki_apap * x[36] / p[72]      # [90] Injection_apap
    Injection_co2c13 = Ki_co2c13 * x[37] / p[73]      # [91] Injection_co2c13
    Injection_metc13 = Ki_metc13 * x[38] / p[74]      # [92] Injection_metc13
    Mar_apap = (x[1] / Var) * p[72]      # [93] Mar_apap
    Mar_co2c13 = (x[2] / Var) * p[73]      # [94] Mar_co2c13
    Mar_metc13 = (x[3] / Var) * p[74]      # [95] Mar_metc13
    Mbo_apap = (x[4] / Vbo) * p[72]      # [96] Mbo_apap
    Mbo_co2c13 = (x[5] / Vbo) * p[73]      # [97] Mbo_co2c13
    Mbo_metc13 = (x[7] / Vbo) * p[74]      # [98] Mbo_metc13
    Mgu_apap = (x[9] / Vgu) * p[72]      # [99] Mgu_apap
    Mgu_co2c13 = (x[10] / Vgu) * p[73]      # [100] Mgu_co2c13
    Mgu_metc13 = (x[11] / Vgu) * p[74]      # [101] Mgu_metc13
    Mhe_apap = (x[12] / Vhe) * p[72]      # [102] Mhe_apap
    Mhe_co2c13 = (x[13] / Vhe) * p[73]      # [103] Mhe_co2c13
    Mhe_metc13 = (x[14] / Vhe) * p[74]      # [104] Mhe_metc13
    Mki_apap = (x[15] / Vki) * p[72]      # [105] Mki_apap
    Mki_co2c13 = (x[16] / Vki) * p[73]      # [106] Mki_co2c13
    Mki_metc13 = (x[17] / Vki) * p[74]      # [107] Mki_metc13
    Mli_apap = (x[18] / Vli) * p[72]      # [108] Mli_apap
    Mli_co2c13 = (x[19] / Vli) * p[73]      # [109] Mli_co2c13
    Mli_metc13 = (x[20] / Vli) * p[74]      # [110] Mli_metc13
    Mlu_apap = (x[21] / Vlu) * p[72]      # [111] Mlu_apap
    Mlu_co2c13 = (x[22] / Vlu) * p[73]      # [112] Mlu_co2c13
    Mlu_metc13 = (x[23] / Vlu) * p[74]      # [113] Mlu_metc13
    Msp_apap = (x[27] / Vsp) * p[72]      # [114] Msp_apap
    Msp_co2c13 = (x[28] / Vsp) * p[73]      # [115] Msp_co2c13
    Msp_metc13 = (x[29] / Vsp) * p[74]      # [116] Msp_metc13
    Mve_apap = (x[33] / Vve) * p[72]      # [117] Mve_apap
    Mve_co2c13 = (x[34] / Vve) * p[73]      # [118] Mve_co2c13
    Mve_metc13 = (x[35] / Vve) * p[74]      # [119] Mve_metc13
    P_CO2 = BSA * p[75] / 60      # [120] P_CO2
    QC = (CO / 1000) * 3600      # [121] QC
    Vplas_art = Vpl * Var / (Vve + Var)      # [122] Vplas_art
    Vplas_ven = Vpl * Vve / (Vve + Var)      # [123] Vplas_ven
    Vre = p[6] * FVre      # [124] Vre
    Xbody_apap = Xar_apap + Xbo_apap + Xhe_apap + Xgu_apap + Xki_apap + Xli_apap + Xlu_apap + Xsp_apap + Xre_apap + Xve_apap      # [125] Xbody_apap
    Xbody_co2c13 = Xar_co2c13 + Xbo_co2c13 + Xhe_co2c13 + Xgu_co2c13 + Xki_co2c13 + Xli_co2c13 + Xlu_co2c13 + Xsp_co2c13 + Xre_co2c13 + Xve_co2c13      # [126] Xbody_co2c13
    Xbody_metc13 = Xar_metc13 + Xbo_metc13 + Xhe_metc13 + Xgu_metc13 + Xki_metc13 + Xli_metc13 + Xlu_metc13 + Xsp_metc13 + Xre_metc13 + Xve_metc13      # [127] Xbody_metc13
    CO2FIX = CO2FIX_CLliv * 1 * (Cli_co2c13 / (Cli_co2c13 + p[11]))      # [128] CO2FIX
    Cki_free_apap = Cki_apap * p[85]      # [129] Cki_free_apap
    Cki_free_co2c13 = Cki_co2c13 * p[86]      # [130] Cki_free_co2c13
    Cki_free_metc13 = Cki_metc13 * p[87]      # [131] Cki_free_metc13
    Cli_free_apap = Cli_apap * p[85]      # [132] Cli_free_apap
    Cli_free_co2c13 = Cli_co2c13 * p[86]      # [133] Cli_free_co2c13
    Cli_free_metc13 = Cli_metc13 * p[87]      # [134] Cli_free_metc13
    Cpl_ve_apap = Cve_apap / p[3]      # [135] Cpl_ve_apap
    Cpl_ve_co2c13 = Cve_co2c13 / p[4]      # [136] Cpl_ve_co2c13
    Cpl_ve_metc13 = Cve_metc13 / p[5]      # [137] Cpl_ve_metc13
    Cre_apap = x[24] / Vre      # [138] Cre_apap
    Cre_co2c13 = x[25] / Vre      # [139] Cre_co2c13
    Cre_metc13 = x[26] / Vre      # [140] Cre_metc13
    Exhalation_co2c13 = p[43] * 60 * Clu_co2c13 * Vlu      # [141] Exhalation_co2c13
    Fixation_co2c13 = p[40] * 60 * Cve_co2c13 * Vve * (1 - Cbo_co2c13_fix / p[41])      # [142] Fixation_co2c13
    Mre_apap = (x[24] / Vre) * p[72]      # [143] Mre_apap
    Mre_co2c13 = (x[25] / Vre) * p[73]      # [144] Mre_co2c13
    Mre_metc13 = (x[26] / Vre) * p[74]      # [145] Mre_metc13
    P_CO2c12 = (1 / (1 + p[76])) * P_CO2      # [146] P_CO2c12
    Qbo = QC * p[16]      # [147] Qbo
    Qgu = QC * p[17]      # [148] Qgu
    Qh = QC * p[18]      # [149] Qh
    Qhe = QC * p[19]      # [150] Qhe
    Qki = QC * p[20]      # [151] Qki
    Qlu = QC * p[21]      # [152] Qlu
    Qre = QC * FQre      # [153] Qre
    Qsp = QC * p[22]      # [154] Qsp
    Release_co2c13 = p[42] * 60 * Cbo_co2c13_fix * Vve      # [155] Release_co2c13
    APAPD = APAPD_CLliv * 1 * (Cli_free_apap / (Cli_free_apap + p[2]))      # [156] APAPD
    CYP1A2MET = CYP1A2MET_CLliv * 1 * (Cli_free_metc13 / (Cli_free_metc13 + p[15]))      # [157] CYP1A2MET
    P_CO2c13 = (p[76] / (1 + p[76])) * P_CO2 + Exhalation_co2c13 / 60      # [158] P_CO2c13
    Qha = Qh - Qgu - Qsp      # [159] Qha
    ar_bo_apap = Qbo * Car_apap      # [160] ar_bo_apap
    ar_bo_co2c13 = Qbo * Car_co2c13      # [161] ar_bo_co2c13
    ar_bo_metc13 = Qbo * Car_metc13      # [162] ar_bo_metc13
    ar_gu_apap = Qgu * Car_apap      # [163] ar_gu_apap
    ar_gu_co2c13 = Qgu * Car_co2c13      # [164] ar_gu_co2c13
    ar_gu_metc13 = Qgu * Car_metc13      # [165] ar_gu_metc13
    ar_he_apap = Qhe * Car_apap      # [166] ar_he_apap
    ar_he_co2c13 = Qhe * Car_co2c13      # [167] ar_he_co2c13
    ar_he_metc13 = Qhe * Car_metc13      # [168] ar_he_metc13
    ar_ki_apap = Qki * Car_apap      # [169] ar_ki_apap
    ar_ki_co2c13 = Qki * Car_co2c13      # [170] ar_ki_co2c13
    ar_ki_metc13 = Qki * Car_metc13      # [171] ar_ki_metc13
    ar_re_apap = Qre * Car_apap      # [172] ar_re_apap
    ar_re_co2c13 = Qre * Car_co2c13      # [173] ar_re_co2c13
    ar_re_metc13 = Qre * Car_metc13      # [174] ar_re_metc13
    ar_sp_apap = Qsp * Car_apap      # [175] ar_sp_apap
    ar_sp_co2c13 = Qsp * Car_co2c13      # [176] ar_sp_co2c13
    ar_sp_metc13 = Qsp * Car_metc13      # [177] ar_sp_metc13
    bo_ve_apap = Qbo * (Cbo_apap / p[47]) * p[3]      # [178] bo_ve_apap
    bo_ve_co2c13 = Qbo * (Cbo_co2c13 / p[48]) * p[4]      # [179] bo_ve_co2c13
    bo_ve_metc13 = Qbo * (Cbo_metc13 / p[49]) * p[5]      # [180] bo_ve_metc13
    gu_li_apap = Qgu * (Cgu_apap / p[50]) * p[3]      # [181] gu_li_apap
    gu_li_co2c13 = Qgu * (Cgu_co2c13 / p[51]) * p[4]      # [182] gu_li_co2c13
    gu_li_metc13 = Qgu * (Cgu_metc13 / p[52]) * p[5]      # [183] gu_li_metc13
    he_ve_apap = Qhe * (Che_apap / p[53]) * p[3]      # [184] he_ve_apap
    he_ve_co2c13 = Qhe * (Che_co2c13 / p[54]) * p[4]      # [185] he_ve_co2c13
    he_ve_metc13 = Qhe * (Che_metc13 / p[55]) * p[5]      # [186] he_ve_metc13
    ki_ve_apap = Qki * (Cki_apap / p[56]) * p[3]      # [187] ki_ve_apap
    ki_ve_co2c13 = Qki * (Cki_co2c13 / p[57]) * p[4]      # [188] ki_ve_co2c13
    ki_ve_metc13 = Qki * (Cki_metc13 / p[58]) * p[5]      # [189] ki_ve_metc13
    li_ve_apap = Qh * (Cli_apap / p[59]) * p[3]      # [190] li_ve_apap
    li_ve_co2c13 = Qh * (Cli_co2c13 / p[60]) * p[4]      # [191] li_ve_co2c13
    li_ve_metc13 = Qh * (Cli_metc13 / p[61]) * p[5]      # [192] li_ve_metc13
    lu_ar_apap = Qlu * (Clu_apap / p[62]) * p[3]      # [193] lu_ar_apap
    lu_ar_co2c13 = Qlu * (Clu_co2c13 / p[63]) * p[4]      # [194] lu_ar_co2c13
    lu_ar_metc13 = Qlu * (Clu_metc13 / p[64]) * p[5]      # [195] lu_ar_metc13
    re_ve_apap = Qre * (Cre_apap / p[65]) * p[3]      # [196] re_ve_apap
    re_ve_co2c13 = Qre * (Cre_co2c13 / p[66]) * p[4]      # [197] re_ve_co2c13
    re_ve_metc13 = Qre * (Cre_metc13 / p[67]) * p[5]      # [198] re_ve_metc13
    sp_li_apap = Qsp * (Csp_apap / p[68]) * p[3]      # [199] sp_li_apap
    sp_li_co2c13 = Qsp * (Csp_co2c13 / p[69]) * p[4]      # [200] sp_li_co2c13
    sp_li_metc13 = Qsp * (Csp_metc13 / p[70]) * p[5]      # [201] sp_li_metc13
    ve_lu_apap = Qlu * Cve_apap      # [202] ve_lu_apap
    ve_lu_co2c13 = Qlu * Cve_co2c13      # [203] ve_lu_co2c13
    ve_lu_metc13 = Qlu * Cve_metc13      # [204] ve_lu_metc13
    vre_apap = p[7] * Cki_free_apap      # [205] vre_apap
    vre_co2c13 = p[8] * Cki_free_co2c13      # [206] vre_co2c13
    vre_metc13 = p[9] * Cki_free_metc13      # [207] vre_metc13
    DOB = ((P_CO2c13 / P_CO2c12 - p[76]) / p[76]) * 1000      # [208] DOB
    P_CO2Fc13 = P_CO2c13 / (P_CO2c12 + P_CO2c13)      # [209] P_CO2Fc13
    P_CO2R = P_CO2c13 / P_CO2c12      # [210] P_CO2R
    ar_li_apap = Qha * Car_apap      # [211] ar_li_apap
    ar_li_co2c13 = Qha * Car_co2c13      # [212] ar_li_co2c13
    ar_li_metc13 = Qha * Car_metc13      # [213] ar_li_metc13

    # ode
    list(c(
        dAar_apap = lu_ar_apap - ar_re_apap - ar_bo_apap - ar_gu_apap - ar_he_apap - ar_ki_apap - ar_sp_apap - ar_li_apap,
        dAar_co2c13 = lu_ar_co2c13 - ar_re_co2c13 - ar_bo_co2c13 - ar_gu_co2c13 - ar_he_co2c13 - ar_ki_co2c13 - ar_sp_co2c13 - ar_li_co2c13,
        dAar_metc13 = lu_ar_metc13 - ar_re_metc13 - ar_bo_metc13 - ar_gu_metc13 - ar_he_metc13 - ar_ki_metc13 - ar_sp_metc13 - ar_li_metc13,
        dAbo_apap = ar_bo_apap - bo_ve_apap,
        dAbo_co2c13 = ar_bo_co2c13 - bo_ve_co2c13,
        dAbo_co2c13_fix = Fixation_co2c13 - Release_co2c13,
        dAbo_metc13 = ar_bo_metc13 - bo_ve_metc13,
        dAbreath_co2c13 = Exhalation_co2c13,
        dAgu_apap = Absorption_apap + ar_gu_apap - gu_li_apap,
        dAgu_co2c13 = Absorption_co2c13 + ar_gu_co2c13 - gu_li_co2c13,
        dAgu_metc13 = Absorption_metc13 + ar_gu_metc13 - gu_li_metc13,
        dAhe_apap = ar_he_apap - he_ve_apap,
        dAhe_co2c13 = ar_he_co2c13 - he_ve_co2c13,
        dAhe_metc13 = ar_he_metc13 - he_ve_metc13,
        dAki_apap = -vre_apap + ar_ki_apap - ki_ve_apap,
        dAki_co2c13 = -vre_co2c13 + ar_ki_co2c13 - ki_ve_co2c13,
        dAki_metc13 = -vre_metc13 + ar_ki_metc13 - ki_ve_metc13,
        dAli_apap = (CYP1A2MET - APAPD) + gu_li_apap + sp_li_apap + ar_li_apap - li_ve_apap,
        dAli_co2c13 = (CYP1A2MET - CO2FIX) + gu_li_co2c13 + sp_li_co2c13 + ar_li_co2c13 - li_ve_co2c13,
        dAli_metc13 = -CYP1A2MET + gu_li_metc13 + sp_li_metc13 + ar_li_metc13 - li_ve_metc13,
        dAlu_apap = ve_lu_apap - lu_ar_apap,
        dAlu_co2c13 = -Exhalation_co2c13 + ve_lu_co2c13 - lu_ar_co2c13,
        dAlu_metc13 = ve_lu_metc13 - lu_ar_metc13,
        dAre_apap = ar_re_apap - re_ve_apap,
        dAre_co2c13 = ar_re_co2c13 - re_ve_co2c13,
        dAre_metc13 = ar_re_metc13 - re_ve_metc13,
        dAsp_apap = ar_sp_apap - sp_li_apap,
        dAsp_co2c13 = ar_sp_co2c13 - sp_li_co2c13,
        dAsp_metc13 = ar_sp_metc13 - sp_li_metc13,
        dAurine_apap = vre_apap,
        dAurine_co2c13 = vre_co2c13,
        dAurine_metc13 = vre_metc13,
        dAve_apap = (Injection_apap + Infusion_apap - ve_lu_apap) + re_ve_apap + bo_ve_apap + he_ve_apap + ki_ve_apap + li_ve_apap,
        dAve_co2c13 = (-Fixation_co2c13 + Release_co2c13 + Injection_co2c13 + Infusion_co2c13 - ve_lu_co2c13) + re_ve_co2c13 + bo_ve_co2c13 + he_ve_co2c13 + ki_ve_co2c13 + li_ve_co2c13,
        dAve_metc13 = (Injection_metc13 + Infusion_metc13 - ve_lu_metc13) + re_ve_metc13 + bo_ve_metc13 + he_ve_metc13 + ki_ve_metc13 + li_ve_metc13,
        dIVDOSE_apap = -Injection_apap * p[72],
        dIVDOSE_co2c13 = -Injection_co2c13 * p[73],
        dIVDOSE_metc13 = -Injection_metc13 * p[74],
        dPODOSE_apap = -Absorption_apap * p[72],
        dPODOSE_co2c13 = -Absorption_co2c13 * p[73],
        dPODOSE_metc13 = -Absorption_metc13 * p[74],
        dcum_dose_apap = p[77] * 60,
        dcum_dose_co2c13 = p[78] * 60,
        dcum_dose_metc13 = p[79] * 60
    ))
}

f_y <- function(times, x, p){
    # Calculate y

    Absorption_apap = (p[44] * x[39] / p[72]) * p[34]  # [1] Absorption_apap
    Absorption_co2c13 = (p[45] * x[40] / p[73]) * p[35]  # [2] Absorption_co2c13
    Absorption_metc13 = (p[46] * x[41] / p[74]) * p[36]  # [3] Absorption_metc13
    BSA = 0.024265 * (p[6] / 1)**0.5378 * (p[37] / 1)**0.3964  # [4] BSA
    CO = p[6] * p[12] + (p[38] - p[39]) * p[13] / 60  # [5] CO
    FQre = 1 - (p[16] + p[19] + p[17] + p[20] + p[18] + p[22])  # [6] FQre
    FVre = 1 - (p[24] + p[26] + p[25] + p[27] + p[28] + p[29] + p[31] + p[32] + p[23] + p[30])  # [7] FVre
    Infusion_apap = (p[77] / p[72]) * 60  # [8] Infusion_apap
    Infusion_co2c13 = (p[78] / p[73]) * 60  # [9] Infusion_co2c13
    Infusion_metc13 = (p[79] / p[74]) * 60  # [10] Infusion_metc13
    Ki_apap = (1.386 / p[88]) * 3600  # [11] Ki_apap
    Ki_co2c13 = (1.386 / p[89]) * 3600  # [12] Ki_co2c13
    Ki_metc13 = (1.386 / p[90]) * 3600  # [13] Ki_metc13
    Var = p[6] * p[23]  # [14] Var
    Vbo = p[6] * p[24]  # [15] Vbo
    Vgu = p[6] * p[25]  # [16] Vgu
    Vhe = p[6] * p[26]  # [17] Vhe
    Vki = p[6] * p[27]  # [18] Vki
    Vli = p[6] * p[28]  # [19] Vli
    Vlu = p[6] * p[29]  # [20] Vlu
    Vpl = p[6] * p[30]  # [21] Vpl
    Vsp = p[6] * p[31]  # [22] Vsp
    Vve = p[6] * p[32]  # [23] Vve
    Xar_apap = x[1] * p[72]  # [24] Xar_apap
    Xar_co2c13 = x[2] * p[73]  # [25] Xar_co2c13
    Xar_metc13 = x[3] * p[74]  # [26] Xar_metc13
    Xbo_apap = x[4] * p[72]  # [27] Xbo_apap
    Xbo_co2c13 = x[5] * p[73]  # [28] Xbo_co2c13
    Xbo_co2c13_fix = x[6] * p[73]  # [29] Xbo_co2c13_fix
    Xbo_metc13 = x[7] * p[74]  # [30] Xbo_metc13
    Xbreath_co2c13 = x[8] * p[73]  # [31] Xbreath_co2c13
    Xgu_apap = x[9] * p[72]  # [32] Xgu_apap
    Xgu_co2c13 = x[10] * p[73]  # [33] Xgu_co2c13
    Xgu_metc13 = x[11] * p[74]  # [34] Xgu_metc13
    Xhe_apap = x[12] * p[72]  # [35] Xhe_apap
    Xhe_co2c13 = x[13] * p[73]  # [36] Xhe_co2c13
    Xhe_metc13 = x[14] * p[74]  # [37] Xhe_metc13
    Xki_apap = x[15] * p[72]  # [38] Xki_apap
    Xki_co2c13 = x[16] * p[73]  # [39] Xki_co2c13
    Xki_metc13 = x[17] * p[74]  # [40] Xki_metc13
    Xli_apap = x[18] * p[72]  # [41] Xli_apap
    Xli_co2c13 = x[19] * p[73]  # [42] Xli_co2c13
    Xli_metc13 = x[20] * p[74]  # [43] Xli_metc13
    Xlu_apap = x[21] * p[72]  # [44] Xlu_apap
    Xlu_co2c13 = x[22] * p[73]  # [45] Xlu_co2c13
    Xlu_metc13 = x[23] * p[74]  # [46] Xlu_metc13
    Xre_apap = x[24] * p[72]  # [47] Xre_apap
    Xre_co2c13 = x[25] * p[73]  # [48] Xre_co2c13
    Xre_metc13 = x[26] * p[74]  # [49] Xre_metc13
    Xsp_apap = x[27] * p[72]  # [50] Xsp_apap
    Xsp_co2c13 = x[28] * p[73]  # [51] Xsp_co2c13
    Xsp_metc13 = x[29] * p[74]  # [52] Xsp_metc13
    Xurine_apap = x[30] * p[72]  # [53] Xurine_apap
    Xurine_co2c13 = x[31] * p[73]  # [54] Xurine_co2c13
    Xurine_metc13 = x[32] * p[74]  # [55] Xurine_metc13
    Xve_apap = x[33] * p[72]  # [56] Xve_apap
    Xve_co2c13 = x[34] * p[73]  # [57] Xve_co2c13
    Xve_metc13 = x[35] * p[74]  # [58] Xve_metc13
    APAPD_CLliv = (p[1] / p[82]) * p[71] * Vli * p[33] * 60 / 1000  # [59] APAPD_CLliv
    CO2FIX_CLliv = p[10] * p[71] * Vli * p[33] * 60 / 1000  # [60] CO2FIX_CLliv
    CYP1A2MET_CLliv = (p[14] / p[84]) * p[71] * Vli * p[33] * 60 / 1000  # [61] CYP1A2MET_CLliv
    Car_apap = x[1] / Var  # [62] Car_apap
    Car_co2c13 = x[2] / Var  # [63] Car_co2c13
    Car_metc13 = x[3] / Var  # [64] Car_metc13
    Cbo_apap = x[4] / Vbo  # [65] Cbo_apap
    Cbo_co2c13 = x[5] / Vbo  # [66] Cbo_co2c13
    Cbo_co2c13_fix = x[6] / Vbo  # [67] Cbo_co2c13_fix
    Cbo_metc13 = x[7] / Vbo  # [68] Cbo_metc13
    Cgu_apap = x[9] / Vgu  # [69] Cgu_apap
    Cgu_co2c13 = x[10] / Vgu  # [70] Cgu_co2c13
    Cgu_metc13 = x[11] / Vgu  # [71] Cgu_metc13
    Che_apap = x[12] / Vhe  # [72] Che_apap
    Che_co2c13 = x[13] / Vhe  # [73] Che_co2c13
    Che_metc13 = x[14] / Vhe  # [74] Che_metc13
    Cki_apap = x[15] / Vki  # [75] Cki_apap
    Cki_co2c13 = x[16] / Vki  # [76] Cki_co2c13
    Cki_metc13 = x[17] / Vki  # [77] Cki_metc13
    Cli_apap = x[18] / Vli  # [78] Cli_apap
    Cli_co2c13 = x[19] / Vli  # [79] Cli_co2c13
    Cli_metc13 = x[20] / Vli  # [80] Cli_metc13
    Clu_apap = x[21] / Vlu  # [81] Clu_apap
    Clu_co2c13 = x[22] / Vlu  # [82] Clu_co2c13
    Clu_metc13 = x[23] / Vlu  # [83] Clu_metc13
    Csp_apap = x[27] / Vsp  # [84] Csp_apap
    Csp_co2c13 = x[28] / Vsp  # [85] Csp_co2c13
    Csp_metc13 = x[29] / Vsp  # [86] Csp_metc13
    Cve_apap = x[33] / Vve  # [87] Cve_apap
    Cve_co2c13 = x[34] / Vve  # [88] Cve_co2c13
    Cve_metc13 = x[35] / Vve  # [89] Cve_metc13
    Injection_apap = Ki_apap * x[36] / p[72]  # [90] Injection_apap
    Injection_co2c13 = Ki_co2c13 * x[37] / p[73]  # [91] Injection_co2c13
    Injection_metc13 = Ki_metc13 * x[38] / p[74]  # [92] Injection_metc13
    Mar_apap = (x[1] / Var) * p[72]  # [93] Mar_apap
    Mar_co2c13 = (x[2] / Var) * p[73]  # [94] Mar_co2c13
    Mar_metc13 = (x[3] / Var) * p[74]  # [95] Mar_metc13
    Mbo_apap = (x[4] / Vbo) * p[72]  # [96] Mbo_apap
    Mbo_co2c13 = (x[5] / Vbo) * p[73]  # [97] Mbo_co2c13
    Mbo_metc13 = (x[7] / Vbo) * p[74]  # [98] Mbo_metc13
    Mgu_apap = (x[9] / Vgu) * p[72]  # [99] Mgu_apap
    Mgu_co2c13 = (x[10] / Vgu) * p[73]  # [100] Mgu_co2c13
    Mgu_metc13 = (x[11] / Vgu) * p[74]  # [101] Mgu_metc13
    Mhe_apap = (x[12] / Vhe) * p[72]  # [102] Mhe_apap
    Mhe_co2c13 = (x[13] / Vhe) * p[73]  # [103] Mhe_co2c13
    Mhe_metc13 = (x[14] / Vhe) * p[74]  # [104] Mhe_metc13
    Mki_apap = (x[15] / Vki) * p[72]  # [105] Mki_apap
    Mki_co2c13 = (x[16] / Vki) * p[73]  # [106] Mki_co2c13
    Mki_metc13 = (x[17] / Vki) * p[74]  # [107] Mki_metc13
    Mli_apap = (x[18] / Vli) * p[72]  # [108] Mli_apap
    Mli_co2c13 = (x[19] / Vli) * p[73]  # [109] Mli_co2c13
    Mli_metc13 = (x[20] / Vli) * p[74]  # [110] Mli_metc13
    Mlu_apap = (x[21] / Vlu) * p[72]  # [111] Mlu_apap
    Mlu_co2c13 = (x[22] / Vlu) * p[73]  # [112] Mlu_co2c13
    Mlu_metc13 = (x[23] / Vlu) * p[74]  # [113] Mlu_metc13
    Msp_apap = (x[27] / Vsp) * p[72]  # [114] Msp_apap
    Msp_co2c13 = (x[28] / Vsp) * p[73]  # [115] Msp_co2c13
    Msp_metc13 = (x[29] / Vsp) * p[74]  # [116] Msp_metc13
    Mve_apap = (x[33] / Vve) * p[72]  # [117] Mve_apap
    Mve_co2c13 = (x[34] / Vve) * p[73]  # [118] Mve_co2c13
    Mve_metc13 = (x[35] / Vve) * p[74]  # [119] Mve_metc13
    P_CO2 = BSA * p[75] / 60  # [120] P_CO2
    QC = (CO / 1000) * 3600  # [121] QC
    Vplas_art = Vpl * Var / (Vve + Var)  # [122] Vplas_art
    Vplas_ven = Vpl * Vve / (Vve + Var)  # [123] Vplas_ven
    Vre = p[6] * FVre  # [124] Vre
    Xbody_apap = Xar_apap + Xbo_apap + Xhe_apap + Xgu_apap + Xki_apap + Xli_apap + Xlu_apap + Xsp_apap + Xre_apap + Xve_apap  # [125] Xbody_apap
    Xbody_co2c13 = Xar_co2c13 + Xbo_co2c13 + Xhe_co2c13 + Xgu_co2c13 + Xki_co2c13 + Xli_co2c13 + Xlu_co2c13 + Xsp_co2c13 + Xre_co2c13 + Xve_co2c13  # [126] Xbody_co2c13
    Xbody_metc13 = Xar_metc13 + Xbo_metc13 + Xhe_metc13 + Xgu_metc13 + Xki_metc13 + Xli_metc13 + Xlu_metc13 + Xsp_metc13 + Xre_metc13 + Xve_metc13  # [127] Xbody_metc13
    CO2FIX = CO2FIX_CLliv * 1 * (Cli_co2c13 / (Cli_co2c13 + p[11]))  # [128] CO2FIX
    Cki_free_apap = Cki_apap * p[85]  # [129] Cki_free_apap
    Cki_free_co2c13 = Cki_co2c13 * p[86]  # [130] Cki_free_co2c13
    Cki_free_metc13 = Cki_metc13 * p[87]  # [131] Cki_free_metc13
    Cli_free_apap = Cli_apap * p[85]  # [132] Cli_free_apap
    Cli_free_co2c13 = Cli_co2c13 * p[86]  # [133] Cli_free_co2c13
    Cli_free_metc13 = Cli_metc13 * p[87]  # [134] Cli_free_metc13
    Cpl_ve_apap = Cve_apap / p[3]  # [135] Cpl_ve_apap
    Cpl_ve_co2c13 = Cve_co2c13 / p[4]  # [136] Cpl_ve_co2c13
    Cpl_ve_metc13 = Cve_metc13 / p[5]  # [137] Cpl_ve_metc13
    Cre_apap = x[24] / Vre  # [138] Cre_apap
    Cre_co2c13 = x[25] / Vre  # [139] Cre_co2c13
    Cre_metc13 = x[26] / Vre  # [140] Cre_metc13
    Exhalation_co2c13 = p[43] * 60 * Clu_co2c13 * Vlu  # [141] Exhalation_co2c13
    Fixation_co2c13 = p[40] * 60 * Cve_co2c13 * Vve * (1 - Cbo_co2c13_fix / p[41])  # [142] Fixation_co2c13
    Mre_apap = (x[24] / Vre) * p[72]  # [143] Mre_apap
    Mre_co2c13 = (x[25] / Vre) * p[73]  # [144] Mre_co2c13
    Mre_metc13 = (x[26] / Vre) * p[74]  # [145] Mre_metc13
    P_CO2c12 = (1 / (1 + p[76])) * P_CO2  # [146] P_CO2c12
    Qbo = QC * p[16]  # [147] Qbo
    Qgu = QC * p[17]  # [148] Qgu
    Qh = QC * p[18]  # [149] Qh
    Qhe = QC * p[19]  # [150] Qhe
    Qki = QC * p[20]  # [151] Qki
    Qlu = QC * p[21]  # [152] Qlu
    Qre = QC * FQre  # [153] Qre
    Qsp = QC * p[22]  # [154] Qsp
    Release_co2c13 = p[42] * 60 * Cbo_co2c13_fix * Vve  # [155] Release_co2c13
    APAPD = APAPD_CLliv * 1 * (Cli_free_apap / (Cli_free_apap + p[2]))  # [156] APAPD
    CYP1A2MET = CYP1A2MET_CLliv * 1 * (Cli_free_metc13 / (Cli_free_metc13 + p[15]))  # [157] CYP1A2MET
    P_CO2c13 = (p[76] / (1 + p[76])) * P_CO2 + Exhalation_co2c13 / 60  # [158] P_CO2c13
    Qha = Qh - Qgu - Qsp  # [159] Qha
    ar_bo_apap = Qbo * Car_apap  # [160] ar_bo_apap
    ar_bo_co2c13 = Qbo * Car_co2c13  # [161] ar_bo_co2c13
    ar_bo_metc13 = Qbo * Car_metc13  # [162] ar_bo_metc13
    ar_gu_apap = Qgu * Car_apap  # [163] ar_gu_apap
    ar_gu_co2c13 = Qgu * Car_co2c13  # [164] ar_gu_co2c13
    ar_gu_metc13 = Qgu * Car_metc13  # [165] ar_gu_metc13
    ar_he_apap = Qhe * Car_apap  # [166] ar_he_apap
    ar_he_co2c13 = Qhe * Car_co2c13  # [167] ar_he_co2c13
    ar_he_metc13 = Qhe * Car_metc13  # [168] ar_he_metc13
    ar_ki_apap = Qki * Car_apap  # [169] ar_ki_apap
    ar_ki_co2c13 = Qki * Car_co2c13  # [170] ar_ki_co2c13
    ar_ki_metc13 = Qki * Car_metc13  # [171] ar_ki_metc13
    ar_re_apap = Qre * Car_apap  # [172] ar_re_apap
    ar_re_co2c13 = Qre * Car_co2c13  # [173] ar_re_co2c13
    ar_re_metc13 = Qre * Car_metc13  # [174] ar_re_metc13
    ar_sp_apap = Qsp * Car_apap  # [175] ar_sp_apap
    ar_sp_co2c13 = Qsp * Car_co2c13  # [176] ar_sp_co2c13
    ar_sp_metc13 = Qsp * Car_metc13  # [177] ar_sp_metc13
    bo_ve_apap = Qbo * (Cbo_apap / p[47]) * p[3]  # [178] bo_ve_apap
    bo_ve_co2c13 = Qbo * (Cbo_co2c13 / p[48]) * p[4]  # [179] bo_ve_co2c13
    bo_ve_metc13 = Qbo * (Cbo_metc13 / p[49]) * p[5]  # [180] bo_ve_metc13
    gu_li_apap = Qgu * (Cgu_apap / p[50]) * p[3]  # [181] gu_li_apap
    gu_li_co2c13 = Qgu * (Cgu_co2c13 / p[51]) * p[4]  # [182] gu_li_co2c13
    gu_li_metc13 = Qgu * (Cgu_metc13 / p[52]) * p[5]  # [183] gu_li_metc13
    he_ve_apap = Qhe * (Che_apap / p[53]) * p[3]  # [184] he_ve_apap
    he_ve_co2c13 = Qhe * (Che_co2c13 / p[54]) * p[4]  # [185] he_ve_co2c13
    he_ve_metc13 = Qhe * (Che_metc13 / p[55]) * p[5]  # [186] he_ve_metc13
    ki_ve_apap = Qki * (Cki_apap / p[56]) * p[3]  # [187] ki_ve_apap
    ki_ve_co2c13 = Qki * (Cki_co2c13 / p[57]) * p[4]  # [188] ki_ve_co2c13
    ki_ve_metc13 = Qki * (Cki_metc13 / p[58]) * p[5]  # [189] ki_ve_metc13
    li_ve_apap = Qh * (Cli_apap / p[59]) * p[3]  # [190] li_ve_apap
    li_ve_co2c13 = Qh * (Cli_co2c13 / p[60]) * p[4]  # [191] li_ve_co2c13
    li_ve_metc13 = Qh * (Cli_metc13 / p[61]) * p[5]  # [192] li_ve_metc13
    lu_ar_apap = Qlu * (Clu_apap / p[62]) * p[3]  # [193] lu_ar_apap
    lu_ar_co2c13 = Qlu * (Clu_co2c13 / p[63]) * p[4]  # [194] lu_ar_co2c13
    lu_ar_metc13 = Qlu * (Clu_metc13 / p[64]) * p[5]  # [195] lu_ar_metc13
    re_ve_apap = Qre * (Cre_apap / p[65]) * p[3]  # [196] re_ve_apap
    re_ve_co2c13 = Qre * (Cre_co2c13 / p[66]) * p[4]  # [197] re_ve_co2c13
    re_ve_metc13 = Qre * (Cre_metc13 / p[67]) * p[5]  # [198] re_ve_metc13
    sp_li_apap = Qsp * (Csp_apap / p[68]) * p[3]  # [199] sp_li_apap
    sp_li_co2c13 = Qsp * (Csp_co2c13 / p[69]) * p[4]  # [200] sp_li_co2c13
    sp_li_metc13 = Qsp * (Csp_metc13 / p[70]) * p[5]  # [201] sp_li_metc13
    ve_lu_apap = Qlu * Cve_apap  # [202] ve_lu_apap
    ve_lu_co2c13 = Qlu * Cve_co2c13  # [203] ve_lu_co2c13
    ve_lu_metc13 = Qlu * Cve_metc13  # [204] ve_lu_metc13
    vre_apap = p[7] * Cki_free_apap  # [205] vre_apap
    vre_co2c13 = p[8] * Cki_free_co2c13  # [206] vre_co2c13
    vre_metc13 = p[9] * Cki_free_metc13  # [207] vre_metc13
    DOB = ((P_CO2c13 / P_CO2c12 - p[76]) / p[76]) * 1000  # [208] DOB
    P_CO2Fc13 = P_CO2c13 / (P_CO2c12 + P_CO2c13)  # [209] P_CO2Fc13
    P_CO2R = P_CO2c13 / P_CO2c12  # [210] P_CO2R
    ar_li_apap = Qha * Car_apap  # [211] ar_li_apap
    ar_li_co2c13 = Qha * Car_co2c13  # [212] ar_li_co2c13
    ar_li_metc13 = Qha * Car_metc13  # [213] ar_li_metc13

    # --------------------------------------
    c(Absorption_apap, Absorption_co2c13, Absorption_metc13, BSA, CO, FQre, FVre, Infusion_apap, Infusion_co2c13, Infusion_metc13, Ki_apap, Ki_co2c13, Ki_metc13, Var, Vbo, Vgu, Vhe, Vki, Vli, Vlu, Vpl, Vsp, Vve, Xar_apap, Xar_co2c13, Xar_metc13, Xbo_apap, Xbo_co2c13, Xbo_co2c13_fix, Xbo_metc13, Xbreath_co2c13, Xgu_apap, Xgu_co2c13, Xgu_metc13, Xhe_apap, Xhe_co2c13, Xhe_metc13, Xki_apap, Xki_co2c13, Xki_metc13, Xli_apap, Xli_co2c13, Xli_metc13, Xlu_apap, Xlu_co2c13, Xlu_metc13, Xre_apap, Xre_co2c13, Xre_metc13, Xsp_apap, Xsp_co2c13, Xsp_metc13, Xurine_apap, Xurine_co2c13, Xurine_metc13, Xve_apap, Xve_co2c13, Xve_metc13, APAPD_CLliv, CO2FIX_CLliv, CYP1A2MET_CLliv, Car_apap, Car_co2c13, Car_metc13, Cbo_apap, Cbo_co2c13, Cbo_co2c13_fix, Cbo_metc13, Cgu_apap, Cgu_co2c13, Cgu_metc13, Che_apap, Che_co2c13, Che_metc13, Cki_apap, Cki_co2c13, Cki_metc13, Cli_apap, Cli_co2c13, Cli_metc13, Clu_apap, Clu_co2c13, Clu_metc13, Csp_apap, Csp_co2c13, Csp_metc13, Cve_apap, Cve_co2c13, Cve_metc13, Injection_apap, Injection_co2c13, Injection_metc13, Mar_apap, Mar_co2c13, Mar_metc13, Mbo_apap, Mbo_co2c13, Mbo_metc13, Mgu_apap, Mgu_co2c13, Mgu_metc13, Mhe_apap, Mhe_co2c13, Mhe_metc13, Mki_apap, Mki_co2c13, Mki_metc13, Mli_apap, Mli_co2c13, Mli_metc13, Mlu_apap, Mlu_co2c13, Mlu_metc13, Msp_apap, Msp_co2c13, Msp_metc13, Mve_apap, Mve_co2c13, Mve_metc13, P_CO2, QC, Vplas_art, Vplas_ven, Vre, Xbody_apap, Xbody_co2c13, Xbody_metc13, CO2FIX, Cki_free_apap, Cki_free_co2c13, Cki_free_metc13, Cli_free_apap, Cli_free_co2c13, Cli_free_metc13, Cpl_ve_apap, Cpl_ve_co2c13, Cpl_ve_metc13, Cre_apap, Cre_co2c13, Cre_metc13, Exhalation_co2c13, Fixation_co2c13, Mre_apap, Mre_co2c13, Mre_metc13, P_CO2c12, Qbo, Qgu, Qh, Qhe, Qki, Qlu, Qre, Qsp, Release_co2c13, APAPD, CYP1A2MET, P_CO2c13, Qha, ar_bo_apap, ar_bo_co2c13, ar_bo_metc13, ar_gu_apap, ar_gu_co2c13, ar_gu_metc13, ar_he_apap, ar_he_co2c13, ar_he_metc13, ar_ki_apap, ar_ki_co2c13, ar_ki_metc13, ar_re_apap, ar_re_co2c13, ar_re_metc13, ar_sp_apap, ar_sp_co2c13, ar_sp_metc13, bo_ve_apap, bo_ve_co2c13, bo_ve_metc13, gu_li_apap, gu_li_co2c13, gu_li_metc13, he_ve_apap, he_ve_co2c13, he_ve_metc13, ki_ve_apap, ki_ve_co2c13, ki_ve_metc13, li_ve_apap, li_ve_co2c13, li_ve_metc13, lu_ar_apap, lu_ar_co2c13, lu_ar_metc13, re_ve_apap, re_ve_co2c13, re_ve_metc13, sp_li_apap, sp_li_co2c13, sp_li_metc13, ve_lu_apap, ve_lu_co2c13, ve_lu_metc13, vre_apap, vre_co2c13, vre_metc13, DOB, P_CO2Fc13, P_CO2R, ar_li_apap, ar_li_co2c13, ar_li_metc13)
}


f_z <- function(times, X, p){
    # calculate z
    shape <- dim(X)
    Nt <- shape[1]
    Nx <- shape[2] - 1
    Ny = length(yids)
    Nz = 1 + Nx + Ny
    Z = matrix(, nrow=Nt, ncol=Nz)
    Z[,1] = times
    for (kx in seq(Nx)){
        Z[,(1+kx)] = X[,1+kx]
    }
    for (kt in seq(Nt)){
        y = f_y(t=times[kt], x=X[kt, 2:(Nx+1)], p=p)
        Z[kt, (2+Nx):Nz] = y
    }
    colnames(Z) <- c ("time", xids, yids)
    Z
}